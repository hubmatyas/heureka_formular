<!DOCTYPE html>
<html lang="en">
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<title>Creating a simple to-do application - Part 1</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<script type="text/javascript">

		function ConvertFormToJSON(form){
			var array = jQuery(form).serializeArray();
			var json = {};

			jQuery.each(array, function() {
				json[this.name] = this.value || '';
			});

			return json;
		}

		jQuery(document).on('ready', function() {
			jQuery('form#add-new-task').bind('submit', function(event){
				event.preventDefault();

				var form = this;
				var json = ConvertFormToJSON(form);
				var tbody = jQuery('#to-do-list > tbody');

				$.ajax({
					type: "POST",
					url: "submit.php",
					data: json,
					dataType: "json"
				}).always(function() {
					tbody.append('<tr><th scope="row" style="background-color:' + form['new-task-color'].value +
						'"><input type="checkbox" /></th><td>' + form['new-task-date'].value +
<<<<<<< HEAD
						'</td><td>' + form['new-task-priority'].value + '</td><td>' + form['new-task-name'].value + 
						'</td><td>' + form['new-task-desc'].value + '</td><td>' + form['new-task-email'].value + '</td></tr>');	
				}).fail(function() { 
					alert("úspěch"); 
=======
						'</td><td>' + form['new-task-priority'].value + '</td><td>' + form['new-task-name'].value +
						'</td><td>' + form['new-task-desc'].value + '</td><td>' + form['new-task-email'].value + '</td></tr>');
				}).fail(function() {
					alert("Failed to add to-do");
>>>>>>> 638646d3e45523f04465e080c77fc2370d79c904
				});

				return true;
			});
		});
	</script>
</head>
<body>
<div id="page">
	<section id="content">
		<article id="to-do">
			<section class="new-to-do">
				<header>
					<h2>Add a new task</h2>
				</header>
				<form id="add-new-task">
					<label for="new-task-name">Name:</label>
					<input id="new-task-name" name="new-task-name" type="text" required>
					<label for="new-task-date">Date:</label>
					<input id="new-task-date" name="new-task-date" type="datetime" required>
					<br/>
					<label for="new-task-priority">Priority:</label>
					<input id="new-task-priority" name="new-task-priority" type="number" required min="1" max="5" step="1" value="2">
					<label for="new-task-color">Color:</label>
					<input id="new-task-color" name="new-task-color" type="color">
					<br/>
					<label for="new-task-desc">Description:</label>
					<input id="new-task-desc" name="new-task-desc" type="text">
					<br/>
					<label for="new-task-email">Invite:</label>
					<input id="new-task-email" name="new-task-email" type="email" multiple>
					<br />
					<input type="submit" value="Add new" target="_blank">
				</form>
			</section>
			<section>
				<table id="to-do-list">
					<caption>What's up next?</caption>
					<colgroup>
						<col />
						<col />
						<col />
						<col />
						<col />
						<col />
					</colgroup>
					<thead>
						<tr>
							<th scope="col"></th>
							<th scope="col">Date</th>
							<th scope="col">Priority</th>
							<th scope="col">Name</th>
							<th scope="col">Description</th>
							<th scope="col">Invitees</th>
						</tr>
					</thead>
					<tbody>
					</tbody>
				</table>
			</section>
			<footer>
			</footer>
		</article>
		<!-- [/to-do] -->
	</section>
	<!-- [/content] -->
</div>
<!-- [/page] -->
</body>
<script type="text/javascript">

	function ConvertFormToJSON(form){
		var array = jQuery(form).serializeArray();
		var json = {};

		jQuery.each(array, function() {
			json[this.name] = this.value || '';
		});

		return json;
	}

	jQuery(document).on('ready', function() {
		jQuery('form#add-new-task').bind('submit', function(event){
			event.preventDefault();

			var form = this;
			var json = ConvertFormToJSON(form);
			var tbody = jQuery('#to-do-list > tbody');

			$.ajax({
				type: "POST",
				url: "submit.php",
				data: json,
				dataType: "json"
			}).always(function() {
				tbody.append('<tr><th scope="row" style="background-color:' + form['new-task-color'].value +
					'"><input type="checkbox" /></th><td>' + form['new-task-date'].value +
					'</td><td>' + form['new-task-priority'].value + '</td><td>' + form['new-task-name'].value +
					'</td><td>' + form['new-task-desc'].value + '</td><td>' + form['new-task-email'].value + '</td></tr>');
			}).fail(function() {
				alert("Failed to add to-do");
			});

			return true;
		});
	});
</script>
</html>
